<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Filmes - Fase 1: Cadastro Manual (DOM Básico)</title>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Catálogo de Filmes</h1>
    
    <form id="cadastro-filme">
        <h2>Adicionar Novo Filme</h2>
        
        <div>
            <label for="titulo">Título do Filme:</label>
            <input type="text" id="titulo" required>
        </div>

        <div>
            <label for="sinopse">Sinopse:</label>
            <textarea id="sinopse" required></textarea>
        </div>

        <div>
            <label for="ano">Ano de Lançamento:</label>
            <input type="number" id="ano" min="1888" max="2099" required>
        </div>

        <div>
            <label for="genero">Gênero:</label>
            <select id="genero" required>
                <option value="">-- Selecione o Gênero --</option>
                <option value="Acao">Ação</option>
                <option value="Comedia">Comédia</option>
                <option value="Drama">Drama</option>
                <option value="Ficcao">Ficção Científica</option>
                <option value="Terror">Terror</option>
                <option value="Documentario">Documentário</option>
                <option value="Outro">Outro</option>
            </select>
        </div>
        
        <div>
            <label for="nota">Nota (0 a 10):</label>
            <input type="number" id="nota" min="0" max="10" step="0.1" required>
        </div>
        
        <button type="submit">Adicionar Filme</button>
    </form>
     
    <hr>

    <h2>Minha lista de filmes</h2>

    <div id="lista-filmes">
        <p id="mensagem-vazia">Nenhum filme cadastrado ainda.</p>
    </div>

    <script>
        // 1. ARMAZENAMENTO DE DADOS
        const catalogo = [];

        // 2. CAPTURA DE ELEMENTOS DO DOM (Input e Contêineres)
        const form = document.getElementById('cadastro-filme');
        const listaFilmesContainer = document.getElementById('lista-filmes');
        const mensagemVazia = document.getElementById('mensagem-vazia');
        
        const inputTitulo = document.getElementById('titulo');
        const inputSinopse = document.getElementById('sinopse');
        const inputAno = document.getElementById('ano');
        const selectGenero = document.getElementById('genero');
        const inputNota = document.getElementById('nota');


        // ------------------------------------
        // FUNÇÃO DE REMOÇÃO
        // ------------------------------------
        /**
        * Remove um filme do array de dados e do elemento HTML na tela.
        * @param {number} indice - A posição do filme no array 'catalogo'.
        * @param {HTMLElement} elementoDOM - O elemento <div> do filme a ser removido da tela.
        */
        function removerFilme(indice, elementoDOM) {
            // 1. Remove o filme do array
            catalogo.splice(indice, 1);
            
            // 2. Remove o elemento HTML da tela
            elementoDOM.remove();

            // 3. Verifica se a lista está vazia para mostrar a mensagem
            if (catalogo.length === 0) {
                mensagemVazia.style.display = 'block';
            }

            // Redesenha a lista para corrigir os índices
            renderizarCatalogo();
        }


        // ------------------------------------
        // FUNÇÃO DE RENDERIZAÇÃO (Desenha o HTML)
        // ------------------------------------
        function renderizarCatalogo() {
            // Limpa o contêiner atual
            listaFilmesContainer.innerHTML = '';
            
            if (catalogo.length === 0) {
                // Se o array está vazio, mostra a mensagem e para a função
                // Adiciona a mensagem de volta (se ela foi removida ao limpar o innerHTML)
                listaFilmesContainer.appendChild(mensagemVazia);
                mensagemVazia.style.display = 'block';
                return;
            } else {
                mensagemVazia.style.display = 'none';
            }

            catalogo.forEach((filme, index) => {
                // 1. Cria o elemento principal do card
                const filmeCard = document.createElement('div');
                filmeCard.classList.add('filme-card');
                
                // 2. Define o conteúdo HTML interno
                filmeCard.innerHTML = `
                    <h3>${filme.titulo} (${filme.ano})</h3>
                    <p><strong>Gênero:</strong> ${filme.genero}</p>
                    <p><strong>Nota:</strong> ${filme.nota.toFixed(1)}/10</p>
                    <p><strong>Sinopse:</strong> ${filme.sinopse}</p>
                    <button class="btn-remover">Remover</button>
                `;
                
                // 3. Adiciona o listener de remoção ao botão recém-criado
                const btnRemover = filmeCard.querySelector('.btn-remover');
                btnRemover.addEventListener('click', () => {
                    // Passa o índice atual (que está correto no loop) e o elemento a ser removido
                    removerFilme(index, filmeCard); 
                });

                // 4. Adiciona o card ao contêiner da lista
                listaFilmesContainer.appendChild(filmeCard);
            });
        }

        // ------------------------------------
        // FUNÇÃO DE CADASTRO (Ao enviar o formulário)
        // ------------------------------------
        form.addEventListener('submit', function(event) {
            // Previne o comportamento padrão (recarregar a página)
            event.preventDefault();

            // 1. Cria o objeto com os dados do filme
            const novoFilme = {
                titulo: inputTitulo.value,
                sinopse: inputSinopse.value,
                // Converte para Number, garantindo o tipo correto
                ano: Number(inputAno.value), 
                // Usamos .text para pegar o nome do Gênero (ex: "Ação")
                genero: selectGenero.options[selectGenero.selectedIndex].text,
                nota: Number(inputNota.value),
            };

            // 2. Adiciona o novo filme ao array global
            catalogo.push(novoFilme);

            // 3. Atualiza a lista na tela (redesenha)
            renderizarCatalogo();

            // 4. Limpa o formulário para o próximo cadastro
            form.reset();
            
            // Coloca o foco no primeiro campo
            inputTitulo.focus(); 
        });
        
        // RENDERIZAÇÃO INICIAL
        renderizarCatalogo();
    </script>
</body>
</html>